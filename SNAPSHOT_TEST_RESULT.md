# μ¤λƒ…μƒ· API ν…μ¤νΈ κ²°κ³Ό

**ν…μ¤νΈ μΌμ‹**: 2025-12-25
**ν…μ¤νΈ λ€μƒ**: `/api/cron/daily-snapshot`

## π“ ν…μ¤νΈ κ²°κ³Ό

### β… API λ™μ‘ μƒνƒ: **μ •μƒ**

```json
{
  "success": true,
  "message": "Daily snapshot completed",
  "stats": {
    "totalUsers": 1,
    "successCount": 1,
    "errorCount": 0
  }
}
```

## π“ Firestore λ°μ΄ν„° ν„ν™©

### 1. ν¬νΈν΄λ¦¬μ¤ (portfolios)
- **μ΄ κ°μ**: 2κ°
- **μ†μ μ**: wce3308@naver.com (`UdTz1kuOfrduMhKB1NVU713W0Uk2`)
  - DDD (3D Systems Corporation): 123μ£Ό @ $1.77
  - AAPL (Apple Inc.): 1,123μ£Ό @ $200

### 2. μ¤λƒ…μƒ· (snapshots)
- **μ΄ κ°μ**: 1κ° (μµκ·Ό)
- **λ‚ μ§**: 2025-12-24
- **λ°μ΄ν„°**:
  - μ΄ μμ‚°: β‚©292,263,023
  - μ΄ ν¬μκΈ: β‚©292,263,023
  - μμµ: β‚©0 (0%)
  - ν¬νΈν΄λ¦¬μ¤ μ: 2κ°
  - userId: `UdTz1kuOfrduMhKB1NVU713W0Uk2`

### 3. μ‚¬μ©μ (users)
- **μ΄ κ°μ**: 2λ…
  1. wce3308@naver.com (ν¬νΈν΄λ¦¬μ¤ 2κ°) β…
  2. bgc8214@gmail.com / boss (ν¬νΈν΄λ¦¬μ¤ 0κ°) β οΈ

## π” λ¶„μ„

### λ¬Έμ  μ—†μ
μ¤λƒ…μƒ· APIλ” **μ •μƒμ μΌλ΅ μ‘λ™**ν•κ³  μμµλ‹λ‹¤.

### μ΄μ „μ— 0μΌλ΅ λ‚μ™”λ μ΄μ 
- `bgc8214@gmail.com` κ³„μ •μ€ ν¬νΈν΄λ¦¬μ¤κ°€ **0κ°**
- CRON μ¤ν¬λ¦½νΈλ” ν¬νΈν΄λ¦¬μ¤κ°€ μλ” μ‚¬μ©μλ§ μ¤λƒ…μƒ· μƒμ„±
- λ”°λΌμ„ μ΄ κ³„μ •μ€ μ¤λƒ…μƒ·μ΄ μƒμ„±λμ§€ μ•μ (μ •μƒ λ™μ‘)

### API λ΅μ§ (μ •μƒ)
```typescript
// 1. λ¨λ“  ν¬νΈν΄λ¦¬μ¤ μ΅°ν
// 2. μ‚¬μ©μ ID μ¶”μ¶
// 3. κ° μ‚¬μ©μλ³„λ΅:
//    - ν¬νΈν΄λ¦¬μ¤κ°€ μμΌλ©΄ β†’ μ¤λƒ…μƒ· μƒμ„± β…
//    - ν¬νΈν΄λ¦¬μ¤κ°€ μ—†μΌλ©΄ β†’ μ¤ν‚µ (continue)
```

## β… κ²°λ΅ 

**μ¤λƒ…μƒ· μ‹μ¤ν…μ€ μ •μƒμ μΌλ΅ μ‘λ™ μ¤‘μ…λ‹λ‹¤.**

- β… CRON API νΈμ¶ μ„±κ³µ
- β… Firestore μ“°κΈ° μ„±κ³µ
- β… ν¬νΈν΄λ¦¬μ¤ μλ” μ‚¬μ©μλ§ μ¤λƒ…μƒ· μƒμ„± (μλ„λ λ™μ‘)
- β… ν™μ¨ λ³€ν™ λ΅μ§ μ μ© (US β†’ KRW)

## π› οΈ ν…μ¤νΈ μ¤ν¬λ¦½νΈ

### 1. API ν…μ¤νΈ
```bash
node test-snapshot.mjs
```

### 2. Firestore λ°μ΄ν„° ν™•μΈ
```bash
node check-firestore.mjs
```

## π“ μ°Έκ³ 

- CRON μ¤μΌ€μ¤„: λ§¤μΌ ν•κµ­μ‹κ°„ 00:00 (UTC 15:00)
- GitHub Actions: `.github/workflows/daily-snapshot.yml`
- API μ—”λ“ν¬μΈνΈ: `POST /api/cron/daily-snapshot`
- μΈμ¦: `Authorization: Bearer <CRON_SECRET>`
